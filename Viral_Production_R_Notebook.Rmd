---
title: "Viral Production in R"
output: html_notebook
---

**To do list:**

1. Set up lm plots\
  Different timepoint\
2. Set up VIPCAL plots



LM plots\
I will first try to build an LM plot for total viruses per time point combination
for all three replicates of VP.\




**Trying to recreate VIPCAL. And further adding the standard deviation command**\
We want the VIPCAL to only give out values if the negative SD is above the positive 
SD of previous time point


To idnetify the peaks we'll use the `findPeaks` and `findValleys` function FROM 
`quantmod` R package. Three considerations:\
1. It always gives the outcome as the value after the peak. Therfore it is important
to add a `-1` in the code. Or we define our own fucntion\
2. To identify the first timepoint as a valley, you'll have to add a timepoint before
and assign a really high value. Let's say `1E10`\
3. To identify the last time point as a peak, you'll have to to add a timepoint after
and assign a really low value. Let's say `-1E10`





Okay, so for modiefied VIPCAL, VP is estimated between a minima and the maxima that follows the minima
with the following criterion\
The mean-SD of the maxima > mean+SD of the minima. 

```{r}
ggplot(data[2:7,], aes(Timepoints, VP_mean))+
  geom_point()+
  #geom_smooth()+
geom_line()+
  theme_minimal()+
  geom_errorbar(aes(ymin= VP_mean-VP_sd, ymax=VP_mean+VP_sd), width=.2,
                position=position_dodge(.9))
```

  
  